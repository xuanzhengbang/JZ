<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>军转大酒店</title>
  <!-- start: Css -->
  <link rel="stylesheet" type="text/css" href="/css/bootstrap.min.css">
  <!-- plugins -->

  <link rel="stylesheet" type="text/css" href="/css/plugins/simple-line-icons.css" />
  <link rel="stylesheet" type="text/css" href="/css/plugins/animate.min.css" />
  <link rel="stylesheet" type="text/css" href="/css/plugins/fullcalendar.min.css" />
  <link href="/css/style.css" rel="stylesheet">
  <!-- end: Css -->
  <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
  <script src="/js/html5shiv.min.js"></script>
  <script src="/js/respond.min.js"></script>
  <![endif]-->
</head>

<body id="mimin" class="dashboard">
<!-- start: Header -->
<nav class="navbar navbar-default header navbar-fixed-top">
  <div class="col-md-12 nav-wrapper">
    <div class="navbar-header" style="width:100%;margin-top: 36px;margin-left: -20px">

      <ul class="nav navbar-nav navbar-right user-nav">
        <li class="user-name"><span>管理员</span></li>
        <li class="dropdown avatar-dropdown"> <img src="/img/head.png" class="img-circle avatar" alt="user name" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true" />
          <ul class="dropdown-menu user-dropdown">
            <li>
              <a href="/user/logout.do"><span class="fa fa-power-off"></span> 退出登录</a>
            </li>
          </ul>
        </li>
      </ul>
    </div>
  </div>
</nav>
<!-- end: Header -->
<div class="container-fluid mimin-wrapper">
  <!-- start:Left Menu -->
  <div id="left-menu">
    <div class="sub-left-menu scroll">
      <ul class="nav nav-list">
        <li>
          <div class="left-bg"></div>
        </li>
        <li class="ripple">
          <a href="javascript:void(0);" class="tree-toggle nav-header"><span class="fa-home fa"></span> 菜品 <span class="fa-angle-right fa right-arrow text-right"></span> </a>

          <ul class="nav nav-list tree">
            <li class="nextli">
              <a href="/food/query?type=位上">位上</a>
            </li>
            <li class="nextli">
              <a href="/food/query?type=汤菜">汤菜</a>
            </li>
            <li class="nextli">
              <a href="/food/query?type=素菜">素菜</a>
            </li>
            <li class="nextli">
              <a href="/food/query?type=河鲜">河鲜</a>
            </li>
            <li class="nextli">
              <a href="/food/query?type=荤菜">荤菜</a>
            </li>
            <li class="nextli">
              <a href="/food/query?type=烧菜">烧菜</a>
            </li>
          </ul>
        </li>


        <li class=" ripple">
          <a href="/dineType" class="sub-tree-toggle nav-header"><span class="fa fa-check-square-o"></span>订餐类别<span class="fa-angle-right fa right-arrow text-right"></span> </a>
        </li>
        <li class="ripple">
          <a href="/foodType" class="sub-tree-toggle nav-header"> <span class="fa-diamond fa"></span>菜品类型<span class="fa-angle-right fa right-arrow text-right"></span> </a>
        </li>
        <li class="active ripple">
          <a href="/food" class="sub-tree-toggle nav-header"><span class="fa fa-calendar-o"></span> 菜品添加<span class="fa-angle-right fa right-arrow text-right"></span> </a>
        </li>
        <li class=" ripple">
          <a href="/setmeal" class="sub-tree-toggle nav-header"><span class="fa fa-calendar-o"></span> 套餐列表<span class="fa-angle-right fa right-arrow text-right"></span> </a>
        </li>
      </ul>
    </div>
  </div>
  <!-- end: Left Menu -->

  <!-- start: content -->
  <div id="content">
    <div class="panel" style="background-color: #55b4ff;">
      <div class="panel-body" style="padding: 0px">
        <div class="col-md-6 col-sm-12" style="padding-top: 18px;">
          <h3 class="animated fadeInLeft">&nbsp;&nbsp;</h3>
          <p class="animated fadeInDown"><span class="fa  fa-map-marker"></span>&nbsp;&nbsp;</p>
        </div>
      </div>
    </div>
    <div id="contents" style="background: white; padding: 5% 8%; margin: 3% 0 0 10%; width: 80%; height: auto;font-size: 16px">
      <table class="table" >
        <caption style="font-size: x-large; text-align: center; margin-bottom: 1%;">菜品列表</caption>
        <thead>
        <tr>
          <th>编号</th>
          <th>名称</th>
          <th>类别</th>
          <th>创建时间</th>
          <th>备注</th>
          <th>操作</th>
        </tr>
        </thead>
        <tbody>
        <tr th:each="item : ${ foods }">
          <td th:text="${ item.id }"></td>
          <td th:text="${ item.name }"></td>
          <td th:text="${ item.typeName }"></td>
          <td th:text="${#dates.format(item.createTime, 'yyyy-MM-dd HH:mm:ss')}"></td>
          <td th:text="${ item.desc }"></td>
          <td>
            <button type="button" class="btn btn-danger" th:id="${item.id}" onclick="del(this)">删除</button>
          </td>
        </tr>
        </tbody>
      </table><br/>

      <ul class="pagination">
        <li><a th:href="${ pageNum-1<1 ? '/food?pageNum='+1 : '/food?pageNum='+ (pageNum-1) }">&laquo;</a></li>
        <li th:each="i : ${ #numbers.sequence(1,total) }" th:class="${ i==pageNum ? 'active':'' }"><a th:href="${'/food?pageNum='+i}" th:text="${i}"></a></li>
        <li><a th:href="${ pageNum+1 > total ? '/food?pageNum=' + total : '/food?pageNum=' + (pageNum+1) }">&raquo;</a></li>
      </ul>
      <button type="button" class="btn btn-success" data-toggle="modal" data-target="#myModal" style="float: right">添加菜品</button>
    </div>
  </div>
</div>
<!-- end: content -->
</div>

<!-- 模态框（Modal） -->
<div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">
          &times;
        </button>
        <h4 class="modal-title" id="myModalLabel">
          添加菜品
        </h4>
      </div>
      <div class="modal-body">
        <input type="text" class="form-control" id="new_food_name" placeholder="请输入名称" /><br/>
        <select class="form-control" id="new_food_type" placeholder="菜品分类">

          <option th:each="type : ${types}"
                  th:value="${type.code}"
                  th:utext="${type.name}"/>
        </select><br/>
        <input type="text" class="form-control" id="new_food_desc" placeholder="备注信息" /><br/>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-default" data-dismiss="modal">关闭
        </button>
        <button type="button" class="btn btn-primary" onclick="add()">
          提  交
        </button>
      </div>
    </div><!-- /.modal-content -->
  </div><!-- /.modal -->
</div>

<div style="text-align:center;">
  建议使用：1366×768或以上分辨率、16Bit颜色、IE6.0以上版本浏览器
  技术支持：雷文科技
</div>
<!-- start: Javascript -->
<script src="/js/jquery.min.js"></script>
<script src="/js/jquery.ui.min.js"></script>
<script src="/js/bootstrap.min.js"></script>
<!-- plugins -->
<script src="/js/plugins/jquery.nicescroll.js"></script>
<script src="/js/main.js"></script>
<script>

    /*$('#myModal').on('shown.bs.modal', function () {
        var $this = $(this);
        var dialog = $this.find('.modal-dialog');
        var top = ($(window).height() - dialog.height()) / 2;
        dialog.css({
            marginTop:top
        });

    });*/
    function add() {
        //获取模态框数据
        var name = $('#new_food_name').val();
        var typeCode = $('#new_food_type').val();
        var desc = $('#new_food_desc').val();

        $.ajax({
            type: "post",
            url: "/food/create",
            data: "name=" + name + "&typeCode=" + typeCode + "&desc=" + desc,
            dataType: 'html',
            contentType: "application/x-www-form-urlencoded; charset=utf-8",
            success: function (result) {
                location.reload();
            }
        });
    }

    function del(obj) {
        if (confirm("确认要删除？")) {
            var id = $(obj).attr("id");
            $.ajax({
                type : "post",
                url : "/food/del.do",
                data : "id=" + id,
                dataType : 'html',
                contentType : "application/x-www-form-urlencoded; charset=utf-8",
                success : function(result) {
                    //$(".table tr:eq(" + id + ")").remove();
                    location.reload();
                }
            });
        }
    }
</script>
</body>

</html>